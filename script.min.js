$(document).ready(function(){let e=$(".disabled-element"),n=$("#numbers"),t=$(".entries"),r=$("#yourAnswer"),s=$("#message"),c="Correct",u="Incorrect",a=$("#controls").outerHeight();$("#display").css("height",`calc(100svh - ${a}px)`);let i=["#1a1a1a","#ff5d52","#fedc09","#b1c642","#68b9d8","#023047","#fb8500","#e63946","#588157","#8338ec"],l=i.length,o={numDigits:parseInt($("#digits").val()),numRows:parseInt($("#rows").val()),timeInterval:parseInt($("#time").val()),includeSubtractions:$("#subtractions").prop("checked"),speakNumbers:$("#speak").prop("checked")};$("#settings_save").click(function(){o.numDigits=parseInt($("#digits").val()),o.numRows=parseInt($("#rows").val()),o.timeInterval=parseInt($("#time").val()),o.includeSubtractions=$("#subtractions").prop("checked"),o.speakNumbers=$("#speak").prop("checked")}),$("#setting_form").validate(),$("#setting_form input").on("input",function(){let e=$(this).valid();$("#settings_save, .btn-close").prop("disabled",!e)});let d={currentIndex:0,numbers:[],playnum:null,currentAnswer:0,entryAdded:!1};function m(){if(e.prop("disabled",!0),s.text(""),n.hide(),d.currentIndex<d.numbers.length){n.fadeIn().text(d.numbers[d.currentIndex]);let c=Math.floor(Math.random()*l);n.css("color",i[c]),o.speakNumbers?b(d.numbers[d.currentIndex]):d.currentIndex++}else clearInterval(d.playnum),n.css("color",i[0]),n.fadeIn().text("?"),e.prop("disabled",!1),r.focus(),d.entryAdded||function e(n){let r=n.map((e,n)=>e>=0?0===n?e:` + ${Math.abs(e)}`:` - ${Math.abs(e)}`).join("");t.append(`${r}<br />`),d.entryAdded=!0}(d.numbers)}$("#play").click(function(){d.currentIndex=0,d.numbers=Array.from({length:o.numRows},()=>{let e="";for(let n=0;n<o.numDigits;n++)e+=Math.floor(10*Math.random());return o.includeSubtractions&&.5>Math.random()?-parseInt(e):parseInt(e)}),d.currentAnswer=d.numbers.reduce((e,n)=>e+n,0),d.entryAdded=!1,r.val(""),o.speakNumbers?m():d.playnum=setInterval(m,o.timeInterval)}),$("#replay").click(function(){d.currentIndex=0,r.val(""),o.speakNumbers?m():d.playnum=setInterval(m,o.timeInterval)}),$("#check").click(function(){d.currentAnswer==r.val()?(s.text(c),o.speakNumbers&&b(c)):(s.text(u),o.speakNumbers&&b(u))});let p=[];function b(e){let n=new SpeechSynthesisUtterance;n.voice=p[2],n.rate=1.5,n.pitch=1,n.lang="en-US",n.text=e,o.speakNumbers&&(n.onend=function(){d.currentIndex++,d.currentIndex<=d.numbers.length&&setTimeout(m,o.timeInterval)}),speechSynthesis.speak(n)}speechSynthesis.onvoiceschanged=function(){p=speechSynthesis.getVoices()}});